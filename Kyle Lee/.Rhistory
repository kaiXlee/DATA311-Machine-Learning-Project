knitr::opts_chunk$set(echo = TRUE)
sui <- read.csv("\Datasets\suicide-rates-overview-1985-to-2016\Suicide.csv", header = TRUE)
sui <- read.csv("/Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
View(sui)
View(sui)
str(sui)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
#****************Data Setup****************#
library(tree)
sui <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(sui)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
observe_num <- nrow(sui)
trainindex <- sample(1:nrow(sui), observe_num*0.8)
sui_train <- sui[trainindex, ]
sui_test <- sui[-trainindex, ]
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita)
plot(sui_lm)
#****************Data Setup****************#
library(tree)
sui <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(sui)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita <- as.numeric(gdp_per_capita)
#**************RF Analysis**************#
set.seed(6421)
load(randomForest)
#**************RF Analysis**************#
set.seed(6421)
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita....)
plot(sui_lm)
abline(linmod, col="blue", lwd=3)
#****************Data Setup****************#
library(tree)
sui <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(sui)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita.... <- as.numeric(gdp_per_capita....)
#****************Data Setup****************#
library(tree)
suicide <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(suicide)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita.... <- as.numeric(gdp_per_capita....)
suicide <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(suicide)
str(suicid)
str(suicide)
#****************Data Setup****************#
library(tree)
suicide <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(suicide)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita <- as.numeric(gdp_per_capita)
#****************Data Setup****************#
library(tree)
suicide <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(suicide)
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita <- as.numeric(sui$gdp_per_capita)
observe_num <- nrow(sui)
trainindex <- sample(1:nrow(sui), observe_num*0.8)
sui_train <- sui[trainindex, ]
sui_test <- sui[-trainindex, ]
#**************RF Analysis**************#
set.seed(6421)
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita....)
#**************RF Analysis**************#
set.seed(6421)
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita)
plot(sui_lm)
abline(linmod, col="blue", lwd=3)
str(sui)
abline(linmod, col="blue", lwd=3)
x <- runif(30,-2,2)
y <- 15+2.3*x-1.5*x^2+rnorm(30)
plot(y~x)
linmod <- lm(y~x)
abline(linmod, col="blue", lwd=3)
plot(sui$suicides_no ~ sui$gdp_per_capita)
plot(sui$suicides_no ~ sui$gdp_per_capita)
sum(sui$ï..country=="Brazil")
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui$ï..country=="Brazil"))
plot(sui$suicides_no ~ sui$gdp_per_capita)
plot(sui$suicides_no ~ sui$gdp_per_capita)
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui$ï..country=="Brazil"))
names(sui)[names(sui) == "ï..country"] <- "country"
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui$country=="Brazil"))
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui, sui$country=="Brazil"))
plot(sui$suicides_no ~ sui$gdp_per_capita)
sui_lm <- lm(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui, sui$country=="a"))
plot(sui$suicides_no ~ sui$gdp_per_capita)
plot(sui$suicides_no ~ sui$gdp_per_capita, data = subset(sui, sui$country=="a"))
plot(sui$suicides_no ~ sui$gdp_per_capita, data=subset(sui, sui$country=="a"))
plot(sui$suicides_no ~ sui$gdp_per_capita, data=subset(sui, sui$country=="1"))
str(sui)
data <- subset(sui, sui$country=="brazil")
nrow(data)
data
data
data <- sui[ which(sui$country=="brazil")]
data
nrow(data)
data
View(data)
data <- subset(sui, country=="brazil")
data
nrow(data)
nrow(sui)
colnames(sui)
sui$country
data <- subset(sui, country=="Brazil")
nrow(data)
nrow
plot(sui$suicides_no ~ sui$gdp_per_capita, data=subset(sui, country=="Brazil"))
plot(suicides_no ~ gdp_per_capita, data=subset(sui, country=="Brazil"))
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum)
agg
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum)
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum)
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum)
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum))
agg <- aggregate(sui, by=list(sui$country, sui$year, FUN = sum))
agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(sui$country~ sui$suicides_no, sui,sum)
typeof(sui$suicides_no)
sum(sui$suicides_no)
agg <- aggregate(sui$suicides_no~ sui$country, sui,sum)
View(agg)
agg <- aggregate(sui$suicides_no ~ sui$country+sui$year, sui,sum)
View(agg)
agg <- aggregate(sui$suicides_no ~ +sui$year, sui,sum)
typeof(agg)
agg <- aggregate(suicides_no ~ +year, sui,sum)
View(agg)
agg <- data.frame(agg)
typeof(agg)
plot(agg$suicides_no ~ agg$year)
View(agg)
agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
#****************Data Setup****************#
library(tree)
suicide <- read.csv("Datasets/suicide-rates-overview-1985-to-2016/Suicide.csv", header = TRUE)
sui <- data.frame(suicide)
names(sui)[names(sui) == "ï..country"] <- "country"
sui$gdp_for_year <- as.numeric(sui$gdp_for_year)
sui$suicides_no <- as.numeric(sui$suicides_no)
sui$gdp_per_capita <- as.numeric(sui$gdp_per_capita)
observe_num <- nrow(sui)
trainindex <- sample(1:nrow(sui), observe_num*0.8)
sui_train <- sui[trainindex, ]
sui_test <- sui[-trainindex, ]
agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
plot(agg$suicides_no ~ agg$year)
View(agg)
sui_lm <- lm(agg$suicides_no ~ agg$year)
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
plot(agg$suicides_no ~ agg$year)
abline(sui_lm, col="blue", lwd=3)
#**************Tree Analysis**************#
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
plot(agg$suicides_no ~ agg$year)
fitted(sui_lm, col="blue", lwd=3)
#**************Tree Analysis**************#
## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)
## ------------------------------------------------------------------------
set.seed(3531)
x <- runif(30,-2,2)
y <- 15+2.3*x-1.5*x^2+rnorm(30)
plot(y~x)
linmod <- lm(y~x)
abline(linmod, col="blue", lwd=3)
x2 <- x^2
quadmod <- lm(y~x+x2)
## ------------------------------------------------------------------------
plot(y~x)
curve(15.35+2.27*x-1.67*x^2, add=TRUE, col="red", lwd=3)
## ------------------------------------------------------------------------
library(FNN)
xmat <- cbind(x,x2)
seqx <- seq(from=-2, to=2, by=0.001)
plot(y~x, main="k=20 Green, k=5 Purple, k=1 Brown" )
knnr20 <- knn.reg(xmat, y=y, test=cbind(seqx, seqx^2), k=20)
lines(seqx, knnr20$pred, col="green", lwd=1)
knnr5 <- knn.reg(xmat, y=y, test=cbind(seqx, seqx^2), k=5)
lines(seqx, knnr5$pred, col="purple", lwd=1)
knnr1 <- knn.reg(xmat, y=y, test=cbind(seqx, seqx^2), k=1)
lines(seqx, knnr1$pred, col="brown", lwd=1)
plot(y~x)
abline(linmod, col="blue", lwd=3)
curve(15.35+2.27*x-1.67*x^2, add=TRUE, col="red", lwd=3)
lines(seqx, knnr5$pred, col="purple", lwd=3)
curve(15+2.3*x-1.5*x^2, add=TRUE, col="black", lwd=3, lty="dashed")
## ------------------------------------------------------------------------
set.seed(3531)
x <- runif(30,-2,2)
y <- 15+2.3*x-1.5*x^2+rnorm(30)
plot(y~x)
linmod <- lm(y~x)
abline(linmod, col="blue", lwd=3)
x2 <- x^2
quadmod <- lm(y~x+x2)
## ------------------------------------------------------------------------
plot(y~x)
curve(15.35+2.27*x-1.67*x^2, add=TRUE, col="red", lwd=3)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
f <- fitted(sui_lm, col="blue", lwd=3)
knnr20 <- knn.reg(agg$year, agg$suicides_no, agg, k=20)
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
f <- fitted(sui_lm, col="blue", lwd=3)
knnr20 <- knn.reg(agg$year, agg$suicides_no, agg, k=20)
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
f <- fitted(sui_lm, col="blue", lwd=3)
lines(agg, knnr20$pred, col="green", lwd=1)
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
f <- fitted(sui_lm, col="blue", lwd=3)
plot(agg)
#**************Tree Analysis**************#
#**************RF Analysis**************#
# agg <- aggregate(sui, by=list(sui$country, sui$year), FUN = sum)
agg <- aggregate(suicides_no ~ +year, sui,sum)
sui_lm <- lm(agg$suicides_no ~ agg$year)
f <- fitted(sui_lm, col="blue", lwd=3)
plot(agg)
abline(sui_lm)
#**************Tree Analysis**************#
